---
layout:     post
title:      论文草稿
subtitle:   递归卷积神经网络用于手势识别
date:       2017-12-16
author:     顾剑成
header-img: img/post-bg-ios9-web.jpg
catalog: true
tags:
    - Gesture Recognition
    - Deep Learning
    - Action Recognition
    - Resnet50
    - LSTM
---
> 中文一段,英文一段。

# 递归卷积神经网络用于手势识别(Recurrent Convolutional Neural Network for Gesture Recognition)
>我们提供了一种方法用于训练和预测视频中的手势，在我们的工作中，我们设计了一种神经网络结构，使用通用的CNN网络结构进行特征提取，使用LSTM进行时间序列特征提取，我们的实验在VIVA Gesture数据集上进行，这个数据集拥有19个手势，通过8个人进行采样。经过8次交叉验证得到的平均测试结果表明，我们设计的网络结构优于之前最好的采用3d卷积网络结构的结果，同时，我们采用了不同规模的卷积神经网络作为空间特征提取器进行对比，ResNet50结合LSTM测得的精确度为82.25%，而轻量级的MobileNet结合LSTM测得的精确度为60%。

>Convolutional Neural Network(CNN) bring us advantages to extract image features. The long short term memory(LSTM) is a nature choice to construct time sequence models. We combined these two methods to generate a end-to-end model for gesture recognition and training. In our work, we designed a neural network structure, using the general CNN network to extract frame-level spatial features, using LSTM to extract time sequence features. Our experiments were performed with VIVA Gesture Dataset, this dataset has 19 gestures, labeled by 8 people. Through 8-cross-fold validation, the network structure we designed has better performance than the state of art methods like 3DCNN, also, we compared the results conducted with different general CNNs, the network based on ReNet50 has the accuracy of 82.25% and light-level network MobileNet has the accuracy of 60%.

## Key Words: *Deeplearning CNN LSTM Gesture Recognition*


## Introduction
最近几年，卷积神经网络获得了非常重大的突破，在多个领域有着十分重要的影响。在图像领域，2012年推出了AlexNet，获得了当年ImageNet图像分类比赛冠军，深度学习、神经网络从此成为了计算机研究学者热门的研究方向。在那之后，剑桥研究人员推出了VggNet，这个神经网络采用了较小的3x3的卷积核，使得网络具备更宽广的视野。GoogleNet将不同尺寸的feature map结合进行下一步的卷积运算使得CNN的结构变得更宽。ResNet通过增加直连的支路使得可以进行更深网络的训练。

In recent years, convolutional neural network(CNN) has achieved big breakthrough in many areas. In image recognition field, AlexNet was developed in 2012 and got the championship in ImageNet competition. Since then, deep learning became popular and many powerful CNNs sprang up, such as VGG, ResNet, and GoogleNet.

在视频领域，CNN的出现改变了传统的视频识别方法。在过去，研究学者往往设计一些鲁棒性好的算子进行特征分析和视频内容识别，比如一些边缘算子或光流算法。在深度学习变得流行后，越来越多的学者考虑使用卷积神经网络来进行视频识别。在动作视频领域，XXX基于2D卷积神经网络提出了双流的识别框架，根据视觉传输到人脑中会经历视觉皮层和运动感知皮层的处理，设计了基于空间支路和运动支路的框架。XXX提出了3D卷积用来进行视频监控的行为识别，此后，XXX在1M Sports数据集上训练了C3D的神经网络，该网络在各个视频动作数据集上的表现都接近最优。

Also, in video recognition field, CNN changes traditional video recognition methods. In the past, researchers used to design robust hand-crafted features, such as histograms of optical flow(HOF) to extract time sequence features, and histograms of Oriented Gradient(HOG) to extract spatial features. After that, these features were fed to SVM classifier to get recognition results. To improve the accuracy of video recognition, recently most researchers like to use deep learning models to solve the problem. Simonyan et al.[] designed a two-stream ConvNet architecture, they input RGB values to the spatial network and optical flow values to the motion network. Ji et al.[] provided a 3D ConvNet for human action recognition. After that, Tran et al.[] published C3D Network pretrained on Sports-1M dataset, this is the first general 3D ConvNet for video recognition areas.

在手势识别领域，主要有两种不同的识别方法，静态的方法中主要是基于模板匹配的方法，这种方法中，主要依赖于单帧的特征匹配，通过KNN算法进行分类计算。动态的方法中，主要通过计算光流分析帧与帧之间特征点的运动方向和距离，进行基于策略的动作判别，Chu、Lu通过LK光流算法，设计了用于拍照的手势识别算法。手工设计的动态算法一定程度可以解决简单的手势识别，但对于复杂且种类多样的动作，手工设计的复杂度大大增加。
这篇文章中，我们设计了卷积神经网络和递归神经网络想结合的神经网络结构，所设计的算法设计可以在弱标注信息的手势识别数据集上进行端到端的训练，并适用于实时的手势识别推理，我们设计的算法，在已公布的VIVA Gesture 算法中精确度处于领先。
文章分为这几个部分，第一章介绍深度学习视频图像领域的发展和工作概要，第二章介绍所涉及领域的相关工作，第三章介绍我们提出的网络结构设计，第四章介绍我们的实验，第五章进行总结，引出接下来将要进行的工作。

***
## Related Work
>（介绍手势识别，和LSTM两条线路）

深度学习在图像领域的进展推动了手势识别的研究，2012年AlexNet的发明，ImageNet图像识别比赛的推动，使得众多精彩的网络结构纷纷出现，ResNet通过残差运算进行信息传递，GoogleNet通过结合多个不同感受野进行多尺度信息叠加，在XXX年，XXX推出的XXX网络结构超越了人类在该数据集上的表现。在目标检测领域，Two-Stage的RCNN、SPPNet、Fast RCNN、Faster RCNN的出现，使得检测算法无需像以往一样，人为地提取特征描述子，进行分类判别，最近One-Stage的YOLO、SSD、FPN、RetinaNet的出现，使得目标检测算法在精度和计算效率之间取得平衡。

手势识别是动作识别的子领域，是利用时间序列和空间信息的数据进行模式识别，在动作识别领域，如UCF101、Sports1M等数据集，他们的特点是不同动作所发生的场景不同，有很强烈的空间特性，即使抽一帧使用流行领先的CNN网络就能达到不错的识别精确度。而手势识别则不同，往往场景单一，单帧图片中都是同样的手，手的局部形态不同，相对于一些动作识别的视频库，手势识别的空间特征比较弱，往往依赖很强的时间特征，如挥手手势，从左向右挥手和从右向左挥手是完全不一样的手势，但他们的空间特征相似度很大,时序特征成为非常重要的特征。在提取时序特征的问题上，出现了非常多的有用的方法，Chu，Lu使用光流算法开发了手势识别的拍照交互系统，XXX推出了双流的神经网络设计，将视频中的帧叠加到通道中进行2D卷积，XXX使用3D卷积方法训练手势识别算法。

在解决时序特性上，以往常用手工设计算法来进行识别，机器学习流行后，隐马尔科夫成为重要的用来解决时序问题的算法，递归神经网络出现后，神经网络也能解决时序问题，且效果更好，逐渐替代传统算法。再后来LSTM的出现解决了RNN算法训练过程难以收敛的问题，在语音、自然语言处理、预测数值等问题上有很强大的作用，甚至可以用LSTM进行MNist手写数字识别的任务，达到杰出的性能。

VIVA Gesture Dataset是分割好的手势识别数据集，由8xx多个的平均时长1s和32帧的视频片段组成。识别手势主要存在的问题有以下几点，手的局部变化具备很高的相似性，这考验了算法提取空间特征的能力。其次，算法还需要理解手在运动的过程中产生的时域特征。最后，由于视频识别相比静态图像识别多了时间维度，在算法鲁棒性上，视频识别需要更多的数据才能得到好的性能。这里，我们的工作概要可分为以下几点：

1. 提出了Resnet50结合LSTM的手势识别框架。
2. 在空间提取能力方面，对比了Resnet50，MobileNet的效果。
3. 对比了LSTM和直接使用3D卷积神经网络如3D卷积进行手势识别的效果。
4. 使用了一些有效的数据增强方法，提升手势识别的鲁棒性。

***

## 方法
1. 网络模型

我们考虑手势识别任务既要在空间特征上有比较好的表征能力，又要在抽象的时间维度上提取出有用的时域特征。于是采用了ResNet50这样的CNN结构和LSTM结合的神经网络识别框架。选用的ResNet50是最初的ResNet系列模型（来自论文XXXX)，将最后的1000维的全连层，替换成150维的隐藏层，因为我们认为手势任务和1000类的图像识别任务不同，所识别的目标就是手，需要提取的是手在变换形态、位置时候所对应的空间信息特征，训练过程中我们考虑过19、50、100、150、200，出于计算复杂性、参数量大小与该算法目标复杂度的综合考虑，我们取了150维。
时间序列特征提取的问题上，我们将LSTM模块加入到网络的设计中，从ResNet50提取的特征输入进LSTM中，隐层节点设置了150维，时间窗口设置成6，输出也是150维的向量，我们采用Softmax分类器，将所有时间窗口内LSTM输出的特征进行拼接，最后连接19维的全连层，通过SoftMax计算得到结果，最终的网络结构图如图xxx所示。
2. 预处理
VIVA Gesture Dataset提供了深度和灰度两种视频文件，我们在训练时参考了XXX的3D卷积神经网络进行了一样的预处理方式，首先我们使用Sober算子，对灰度图进行处理得到了梯度图，梯度图的生成可以帮助提取图像边缘信息，梯度图的加入可以提升在不同光照下算法的鲁棒性。我们巧合地将原本输入的RGB三通道设计成输入灰度、梯度、深度三通道，通过这样的输入通道数设计，使得我们可以利用上所有ResNet50在ImageNet上预训练好的权重，加快算法的收敛速度。

3. 数据增强
VIVA Gesture Dataset一共有。。。个视频，包含了19种手势，由8个人进行手势标注，因为每种手势的训练视频非常少，在训练过程中很容易造成过拟合，因此我们需要加入一些数据增强的方法来进行训练，这些方法由。。。提出，被证明是有效的。
我们用到的数据增强主要分为两种，一种是离线增强，在进行训练前提前对硬盘中的数据集进行处理，生成一个新的数据集，由于手势数据集的特殊性，不同手势之间可以通过镜像、逆序的方式进行转换。图xxx，展现了向右挥手手势，经过空间镜像的效果后，变成了向左挥手手势，图xxx中，通过视频帧逆序排列的方式将手势变成向左挥手手势，这两个增强方法还可以进行叠加，进行更多的数据扩充。经过我们的梳理，数据集中xxxxxxxxxxxxxxx可以由xxxxxxxxxxxx进行空间镜像得到，xxxxxxxxxxx可以由xxxxxxxxx进行视频帧逆序得到。
离线增强只能带来一些数据的扩充，但在线增强的方法，可以使得训练的每次迭代都输入不一样的数据，常用的在线数据增强方法有旋转、缩放、加入噪声等，这些方法已经被经常地运用到图像识别和目标检测等图像算法的任务中，我们使用了旋转、缩放还加入了xxx论文中所提到的时间扭曲、random dropping。

## 实验
1. 训练过程
我们使用AdamOptimizer，0.0001作为初始学习率，迭代350个Epoch以保证网络收敛，实验中，我们发现如果打开在线数据增强的预处理方法，网络很难收敛，于是在训练过程中，前20个Epoch不使用在线增强，是的网络可以较好的收敛，然后使用在线数据增强。
2. 测试过程
出于手势识别测试集的特殊性，VIVA Gesture Dataset要求测试过程采用8-fold交叉验证的方法，因为8份数据集的每一份由一个人进行演示得到，数据间有很强的相似性，实验抽取固定比例的数据作为测试数据，测试集和训练集的数据会有很强的相似性，虽然会得到非常好的结果，但无法表示算法具备很好的泛化性。因此8-fold交叉验证法，使得每次训练和测试时，七个人的数据作为训练，第八个人的数据作为测试，测试结果可以体现泛化性能，将这样的训练测试过程迭代8次，得到的8个精确度平均得到最终评测结果。
3. 使用ResNet50和MobileNet作为特征提取器的比较

4.

## 总结
